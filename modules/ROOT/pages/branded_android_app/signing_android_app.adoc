= Building Your App With ownBrander
:toc: right

== Signing Android Client

The next option is *Sign Android Client*.
You can upload your signing certificate into the wizard so that will be signed during the build process. (Reference Line 49.) Otherwise, you can sign your app after we build it.
See publishing_android_app to learn how to sign your app after it is built. (Is there a link for this?)

Google Play Store requires that certificates have a validity period ending after October 22, 2033. (footnote:[http://developer.android.com/intl/es/tools/publishing/app-signing.html#considerations ])

Additional resources to consult due to changes in the Google Play Store as of August 2021 are as follows: 

* Guide to the Google Play Console:
 (footnote:[https://support.google.com/googleplay/android-developer/  ])

* Play Console Help:
(footnote:[https://support.google.com/googleplay/android-developer/answer/984275 ])

* App-Bundle Guide: 
(footnote:[https://developer.android.com/guide/app-bundle ])

* For those who take deeper dives:
(footnote:[https://github.com/google/bundletool ])


Navigate to the Google Play Console Page and click on the Play Console Button.

https://play.google.com/console/about/

You will then land on the developer account sign-on page. https://play.google.com/console/developers.  After successful log-on, choose the appropriate developers account.

image:branded_android_app/android_app_build_10.png[image]

The page should appear like this. Choose the designated app, which is to be signes and/or updated.

image:branded_android_app/android_app_build_11.png[image]

Navigate to Production, click and continue by clicking the "create new release" button.

image:branded_android_app/android_app_build_12.png[image]
image:branded_android_app/android_app_build_13.png[image]

Google Play Console will prompt you through this. Follow the steps to validate your app-Integrity.  
Click the "activate" button.
(warning) This is necessary in order to use the Android App Bundles (.aab file).

image:branded_android_app/android_app_build_14.png[image]

Play App Signing is a safety feature provided by Google. Every new release will automatically be signed by Google. (With this, Apps no longer need to be signed locally.)

Since this is a new release version candidate, and the key comes from the Java KeyStore, choose this option. 
Otherwise, choose according to your existing key scheme.

image:branded_android_app/android_app_build_15.png[image]

Follow the instructions pertaining to the chosen key scheme. (Here: JavaKeyStore)
Download the PEPK-Tool as instructed.

image:branded_android_app/android_app_build_16.png[image]

Open a terminal window and type the following command with your keystore parameters (KeyStore Alias, Key Store Password and the Key Alias Password) as saved within the ownBrander.

As seen in the screen after the command, you can click on the copy icon in step 2 to copy the entire block, but you must modify the "foo" parts of the command as follows:

Where: _foo.keystore_ must be replaced by the _keystore name_ (here: damken)
_Alias_ is the app name (here: damkencloud) aka the _Key Alias_.

[source,java]
----
java -jar pepk.jar --keystore=foo.keystore --alias=foo --output=encrypted_private_key_path
----

image:branded_android_app/android_app_build_17.png[image]

After executing the above command, you will be prompted to enter both the passwords for "your keystore password" and then for "your key alias password".
Keep in mind, that these passwords are invisible when typing them. (Multiple entries or typos lead to errors.)

image:branded_android_app/android_app_build_18.png[image]

not certain regarding this on other OS than macOS

image:branded_android_app/android_app_build_19.png[image]

Proceed by clicking on the button to upload your private key
image:branded_android_app/android_app_build_20.png[image]

Double-click the file to upload it. After successful upload, click on the "save" button (bottom right of the page).

You will be redirected to the Terms of Use page. Click accept after reading them.

image:branded_android_app/android_app_build_21.png[image]

Navigate back to "Production". The certificate is now available for viewing.

image:branded_android_app/android_app_build_22.png[image]

In the "Production" bar move to the release review button (not certain how it is actually named in english on the Google Play Console)

image:branded_android_app/android_app_build_23.png[image]

Notice the check-mark by the app integrity field.

image:branded_android_app/android_app_build_24.png[image]

Proceed by clicking on "upload" in order to upload your .aab file. (You must download it to your computer system first.)

image:branded_android_app/android_app_build_25.png[image]

You should see Googles colors changing during the upload process. Thereafter, a preview of the app release  candidate.
image:branded_android_app/android_app_build_26.png[image]

The new version is available and should be proofed before releasing it to the production environment

image:branded_android_app/android_app_build_27.png[image]

Optionally, you may want to provide your users with information regarding the changelog, so they know what changes were implemented. 

image:branded_android_app/android_app_build_28.png[image]

You may copy this from a previous release, if available.

image:branded_android_app/android_app_build_29.png[image]

After saving any modifications, proceed by clicking the "check release" button.

You may see some warnings. (If of importance, check to see in what regards they are.) Scroll down. 

image:branded_android_app/android_app_build_30.png[image]

If you opt for a complete roll-out in all of the chosen distribution countries, just click the "Begin Production Release" button.

image:branded_android_app/android_app_build_31.png[image]

Review the chosen distibution and hit the "Release" button. Thereafter, you will receive a release status notification.

image:branded_android_app/android_app_build_32.png[image]

image:branded_android_app/android_app_build_33.png[image]

Notice, that Play App Signing has been successfully implemented.

image:branded_android_app/android_app_build_34.png[image]

Afterwards, you can find the status of your release/update release candidate in the tab "Release-Overview" or "Release Dashboard?"

image:branded_android_app/android_app_build_35.png[image]
